---
version:
- Server v3.x
- Server Admin
---
= CircleCI Server v3.x Configuring External Services
:page-layout: classic-docs
:page-liquid:
:icons: font
:toc: macro
:toc-title:

toc::[]

== External Database and Vault Setup for CircleCI Installations
This document describes how to configure the following external services for use with a CircleCI server 3.0 Installation:

* PostgreSQL v12.6

== PostgreSQL

=== Best Practices for your PostgreSQL

Consider running at least two or more PostgreSQL replicas to enable recovery from primary failure and for backups. Following are the recommended specifications of the PostgreSQL machines:

[.table.table-striped]
[cols=6*, options="header", stripes=even]
|===
|# of Daily Active Users
|# of PostgreSQL Replicas 
|CPU   
|RAM  
|Disk  
|NIC Speed 

|<50                    
|2                         
|8 Cores
|16 GB 
|100 GB 
| 1 Gbps

|50 - 250               
|2                         
|8 Cores
|16 GB 
|200 GB 
|1 Gbps

|250 - 1000             
|3                         
|8 Cores
|32 GB 
|500 GB 
|10 Gbps

|1000 - 5000            
|3                         
|8 Cores
|32 GB 
|1 TB   
|10 Gbps

|5000+                  
|3                         
|8 Cores
|32 GB 
|1 TB   
|10 Gbps
|===

=== Backing Up PostgreSQL
PostgreSQL provides official documentation for backing up and restoring your PostgreSQL 12 install which can be found https://www.postgresql.org/docs/12/backup.html[here].

We strongly recommend the following:

* Taking daily backups
* Keeping at least 30 days of backup
* Using encrypted storage for backups as databases might contain sensitive information
* Performing a backup before each upgrade of CircleCI Server.
